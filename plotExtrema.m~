clear; close all;

% load('extremaMatrixYoung.mat')
% load('extremaMatrixOld.mat')
load('extremaMatrixOldAllMuscles.mat')

% minY = transpose(extremaMatrixYoung(:,:,1));
% maxY = transpose(extremaMatrixYoung(:,:,2));
% ratioY = maxY./minY;

% minO = transpose(extremaMatrixOldAllMuscles(:,:,1));
% maxO = transpose(extremaMatrixOldAllMuscles(:,:,2));
% ratioO = maxO./minO;

load('extremaMatrixOldAllMuscles.mat');

[min_M, max_M, ratio_M] = getExtremaMatrix(extremaMatrixOldAllMuscles);

muscleOrder={'TA', 'PER', 'SOL', 'LG', 'MG', 'BF', 'SEMB', 'SEMT', 'VM', 'VL', 'RF', 'HIP', 'ADM', 'TFL', 'GLU'};
n_muscles = length(muscleOrder);



figure;
plot([1:n_muscles],minO(1:n_muscles,:),'o');
hold on
plot([1:n_muscles]+.4,minO(n_muscles+1:n_muscles*2,:),'d','LineWidth',3)
title('Old Subjects Min EMG Voltages All Muscles')
%legend('s1: f','s2: f','s3: f','s4: f','s5: f','s6: f','s7: f','s1: s','s2: s','s3: s','s4: s','s5: s','s6: s','s7: s')
set(gca,'XTick',1:n_muscles,'XTickLabel',muscleOrder,'YScale','log','Ytick',min(min(minO)):10^-6:max(max(minO)))
axis tight;
grid on


figure;
plot([1:n_muscles],maxO(1:n_muscles,:),'o');
hold on
plot([1:n_muscles]+.4,maxO(n_muscles+1:n_muscles*2,:),'d','LineWidth',3)
title('Old SubjectsMax EMG Voltages All Muscles')
set(gca,'XTick',1:n_muscles,'XTickLabel',muscleOrder,'YScale','log','Ytick',min(min(maxO)):10^-5:max(max(maxO)));
axis tight;
grid on

% plot([1:5],maxY(1:5,:),'o');
% hold on
% plot([1:5]+.2,maxY(6:10,:),'o','LineWidth',2)
% title('Max Young')
% legend('s1: f','s2: f','s3: f','s4: f','s5: f','s6: f','s7: f','s1: s','s2: s','s3: s','s4: s','s5: s','s6: s','s7: s')
% set(gca,'XTick',1:5,'XTickLabel',muscleOrder,'YScale','log','YLim',[2e-6 5e-4],'Ytick',10.^[-6:.5:-4])
% grid on


% figure;
% plot([1:5]+.2,ratioY(1:5,:),'o','MarkerEdgeColor','b');
% hold on
% plot([1:5]+.4,ratioY(6:10,:),'d','MarkerEdgeColor','b');
% hold on 
% plot([1:5]+.6,ratioO(1:5,:),'o','MarkerEdgeColor','r');
% hold on 
% plot([1:5]+.8,ratioO(6:10,:),'d','MarkerEdgeColor','red');
% 
% title('Ratio of Max to Min EMG Voltages')
% legend('blue = young','red = old', 'circle = fast leg', 'diamond = slow leg');
% set(gca,'XTick',1:5,'XTickLabel',{'TA','MG','SEMT','VL','RF'},'YScale','log','Ytick',(0:5:60))
% axis([.8 6 1 100]);
% grid on;

%saveas(fh,'./Figures/YoungExtrema.fig')
